#!/usr/bin/env node

'use strict'
import catchGlobalErrors from '@xen-orchestra/log/configure'
import createLogger from '@xen-orchestra/log'

const log = createLogger('xo:xo-server')

// ===================================================================

// Better stack traces if possible.
require('../better-stacks')

// Use Bluebird for all promises as it provides better performance and
// less memory usage.
global.Promise = require('bluebird')

// Make unhandled rejected promises visible.
process.on('unhandledRejection', function (reason) {
  console.warn('[Warn] Possibly unhandled rejection:', reason && reason.stack || reason)
})

catchGlobalErrors(log)

require('exec-promise')(require('../'))
